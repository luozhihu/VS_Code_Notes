# 什么是Internet
- 网络
- 计算机网络
- 互联网
## 什么是Internet：从具体构成来看
- 节点
  - 主机及其上运行的应用程序
  - 路由器、交换机等网络交换设备
- 边：通讯链路
  - 接入网链路：主机连接到互联网的链路
  - 主干链路：路由器间的链路
- 协议控制发送、接收消息
  - 如TCP、IP、HTTP、FTP、PPP
- 数以亿计的、互联的计算设备
  - 主机 = 端系统
  - 运行网络应用程序
- 通讯链路
  - 光纤、同轴电缆、无线电、卫星
  - 传输速率 = 带宽
- 分组交换设备：转发分组（packets）
  - 路由和交换机
- Internet：“网络的网络”
  - 松散的称此结构，互联的ISP
  - 公共INTERnet vs. 专用Internet
- Internet标准
  - RFC：Request for comments
  - IETF：Internet Engineering Task Force
# 网络边缘
- 端系统（主机）
  - 运行应用程序
  - 如Web、email
  - 在网络的边缘
- 客户、服务器模式
  - 客户端向服务器请求、接受服务
  - 如Web浏览器、服务器email客户端、服务器
- 对等模式（peer-peer）模式
  - 很少专门的服务器
  - 如Gnutella、KaZaA、Emule
## 采用网络设施的面向连接服务
- 目标：在端系统之间传输数据
  - 握手：在数据传输之前做好准备
    - 人类协议中：你好，你好
    - 两个通信主机之间为连接建立状态
  - TCP-传输协议（Transmission Control Protocol）
  - Internet上面向连接的服务
- TCP服务
  - 可靠地、按顺序地传送数据
    - 确认和重传
  - 流量控制
    - 发送不会淹没接收方
  - 拥塞控制
    - 当网络拥塞时，发送方减低发送速率。
## 采用基础设施的无连接服务
- 目标：在端系统之间传输数据
  - 无连接服务
  - UDP-用户数据报协议（User Datagram Protocol）
    - 无连接
    - 不可靠数据传输
    - 无流量控制
    - 无拥塞控制
  - 使用TCP的应用：
    - HTTP（Web），FTP（文件传送），Telnet（远程登录），SMTP（email）
  - 使用UDP的应用：
    - 流媒体、远程会议、DNS、Internet电话
# 网络核心
## 电路交换
端到端的资源被分配给从源端到目标端的呼叫“call”：
- 图中，每段链路有四条线路：
  - 该呼叫采用了上面链路的第二条，右边链路的第一条
- 独享资源：不共享
  - 每个呼叫一旦建立起来就能够保证性能
- 如果呼叫没有数据发送，被分配的资源就会被浪费
- 通常被传统电话网络采用

网络资源被分成片
- 为呼叫分配片
- 如果某个呼叫没有数据则其资源篇处于空闲状态
- 将带宽分成片
  - 频分
  - 时分
  - 波分

电路交换不适合计算机之间的通讯
- 连接建立时间长
- 计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多
  - 即使这个呼叫没有数据传递，其所占据的片也不能够被别的呼叫使用
  - 可靠性不高？
## 分组交换
以分组为单位存储-转发方式
- 网络带宽资源不在分为一个个片，传输时使用全部带宽
- 主机之间传输的数据被分为一个个分组

资源共享，按需使用
- 存储-转发：分组每次移动一跳
  - 在转发之前，节点必须受到整个分组
  - 延迟比线路交换要大
  - 排队时间
# 接入网络和物理媒体
- 住宅接入网络
- 单位接入网络
- 无线接入网络

**注意：**
- 接入网络的带宽
- 共享/专用？

**住宅接入：modem**
- 将上网数据调制加载音频信号上，在电话线上传输，在局端将其中的数据调节出来：反之亦然
  - 调频
  - 条幅
  - 调相位
  - 综合调
- 拨号调制解调器
  - 56kbps的速率直接接入路由器
  - 不能同时上网和打电话：不能总是在线
**接入网：digital subseriber line (DSL)**
- 采用先用的到交换局DSLAM的电话线
  - DSL线路上的数据被传到互联网
  - DSL线路上的语音被传到电话网
- 2.5Mbps上行速率
- 24Mbps下行速率

**接入网：线缆网络**
- HFC：hybrid fiber coax
  - 非对称：最高下行30Mbps，最高上行2Mbps
- 线缆和光纤网络将各个家庭用户介入到ISP路由器
- 个用户共享到线缆头端的接入网络
  - 与DSL不同，DSL每个用户一个专用线路到CO（central office）

**无线接入网**
- 各无线端系统共享无线接入网络（端系统到无线路由器）
  - 通过基站或者交接入点
  
**无线LANs**
- 建筑物内
  - 802.11b/g（wifi）：11.54Mbps传输速率

**广域无线接入**
- 由电信运营商提供（cellular），10s km
  - 1到10Mbps
  - 3g，4g：LTE
## 物理媒体
- Bit：在传输-接收对间传播
- 物理链路：在每个传输-接收对，跨越一种物理媒体
- 引导型媒体：型号沿着固体媒介被引导：同轴电缆、光纤、双绞线
- 非引导型媒体：信号自由传播：如无线电

**双绞线**
> 两个绝缘铜线

**同轴电缆**
- 两个同心的铜导线
- 双向
- 基带电缆:
  - 电缆上一个单个信道
  - Ethernet
- 宽带电缆
  - 电缆上由多个信道
  - HFC

**光缆**
- 光脉冲,每个脉冲表示一个bit,在玻璃纤维中传输
- 高速:
  - 点到点传输
- 低误码率:在两个中继器之间可以由很长的距离:不受电磁噪声的干扰
- 安全

**无线链路**
- 开放空间传输电磁波,携带要传输的数据
- 无需物理"线缆"
- 双向
- 传播环境效应:
  - 反射
  - 吸收
  - 干扰
- **无线接入类型:**
  - 地面微波
  - LAN
  - wide-area
  - 卫星
# Internet结构和ISP
## 互联网的结构
- 端系统通过接入ISPs连接到互联网
  - 住宅\公司和大学的ISPs
- 接入ISPs相应的必须是互联的
  - 因此任何2个端系统课互相发送分组到对方
- 导致的"网络的网络"非常复杂
  - 发展和烟花是通过经济的和国家的政策来驱动的
- 让我们采用渐进方法来秒速当前互联网的结构
### 网络的网络
- 在网络的最中心,一些为数不多的从分连接的大范围网络
  - "tier-1" commercial ISPs,国家或者国际范围的覆盖
  - content provider network :将他们的数据中心接入ISP,方便周边用户的访问:通常私有网络之间专用网络绕过第一层ISP和区域ISPs


**松散的层次模型**
- 中心:第一层ISP国家/国际覆盖,速率极高
  - 直接与娶她第一层ISP相连
  - 与大量的第二层ISP和其他客户网络相连
- 第二层ISP:更小的ISP
  - 与一个或多个第一层ISPs,也可能与其他第二层ISP
- 第三层ISP与其他本地ISP
  - 接入网
- 一个分组要经过许多网络
- **很多内容提供商可能会部署自己的网络,连接自己的在各地的DC(数据中心),走自己的数据**
- 连接若干local ISP和各级ISP,更加靠近用户
### ISP之间的连接
- POP:高层ISP面向客户网络的接入点,涉及费用结算
  - 如一个底层ISP接入多个高层ISP
- 对等接入:2个ISP对等互接,不涉及费用结算
- IXP:多个对等ISP互联互通之处,通常不涉及费用结算
- ICP:自己部署专用网络,同时和各级ISP连接
# 分组延时,丢失和吞吐量
## 分组丢失和时延是怎样发生的
**在路由器缓冲区的分组队列**
- 分组到达链路的速率超过了链路输出的能力
- 分组等待排到对头\被传输

**四种分组延时**
1. 节点处理延时:
   1. 检查bit级差错
   2. 检查分组首部和决定将分组到向何处
2. 排队延时:
   1. 在输出链路上等待传输的时间
   2. 依赖于路由器的拥塞程度
3. 传输时延:
   1. R=链路带宽
   2. L=分组长度
   3. 将分组发送到链路上的时间=L/R
   4. 存储转发时延
4. 传播时延:
   1. d=物理链路的长度
   2. s=在媒体上的传播速度
   3. 传播延时=d/s

**分组丢失**
- 链路的队列缓冲区容量有限
- 当分组到达一个满的队列时,该分组将会丢弃
- 丢失的分组可能会被前一个节点的或源端系统重传,或根本不重传
## 吞吐量
- 吞吐量:在源端和目标端之间传输的速率
  - 瞬时吞吐量:在一个时间点的速率
  - 平均吞吐量:在一个长时间内平均值
# 协议层次及服务模型
## 协议层次
**网络是一个复杂的系统**
- 网络功能繁杂:数字信号的物理信号承载,点到点,路由,rdt,进程区分,应用等
- 现实来看,网络的许多构成元素和设备:
  - 主机
  - 路由器
  - 各种媒体的链路
  - 协议
  - 应用
  - 硬件,软件

*如何组织实现网络的功能?*
## 服务和服务访问点
- 服务:低层实体向上层实体提供它们之间的通信的能力
  - 服务用户(service user)
  -  服务提供者(service provider )
- 原语(primitive)：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互的---形式
- 服务访问点 SAP (Services Access Point) ：上层使用下层提供的服务通过层间的接口—地点；
  - 例子:邮箱
  - 地址(address)：下层的一个实体支撑着上层的多个实体，SAP有标志不同上层实体的作用
  - 可以有不同的实现，队列
  - 例子:传输层的SAP: 端口(port)
## 服务的类型
- 面向连接的服务和无连接的服务-方式
  - 面向连接的服务
    - 连接(Connection)：两个通信实体为进行通信而建立的一种结合
    - 面向连接的服务通信的过程：建立连接，通信，拆除连接
    - 面向连接的服务的例子：网络层的连接被成为虚电路
    - 适用范围：对于大的数据块要传输; 不适合小的零星报文
    - 特点：保序
    - 服务类型:
      - 可靠的信息流 传送页面
      - 可靠的字节流 远程登录
      - 不可靠的连接 数字化声音
  - 无连接的服务(Connectionless Service)
    - 无连接服务：两个对等层实体在通信前不需要建立一个连接，不预留资源；不需要通信双方都是活跃；(例：寄信)
    - 特点：不可靠、可能重复、可能失序
    - IP分组，数据包；
    - 适用范围：适合传送零星数据；
    - 服务类型：
      - 不可靠的数据包 电子方式的函件
      - 有确认的数据包 挂号信
      - 请求回答 信息查询
## 服务和协议
-  服务与协议的区别
   - 服务(Service)：低层实体向上层实体提供它们之间的通信的能力，是通过原语(primitive)来操作的，垂直
   -  协议(protocol) ：对等层实体(peer entity)之间在相互通信的过程中，需要遵循的规则的集合，水平
- 服务与协议的联系
  - 本层协议的实现要靠下层提供的服务来实现
  - 本层实体通过协议为上层提供更高级的服务
## 分层处理和实现复杂系统的好处？
**对付复杂的系统**
- 概念化：结构清晰，便于标示网络组件，以及描述其相互关系
  - 分层参考模型
- 结构化：模块化更易于维护和系统升级
  - 改变某一层服务的实现不影响系统中的其他层次
    - 对于其他层次而言是透明的
  - 如改变登机程序并不影响系统的其它部分
    - 改变2个秘书使用的通信方式不影响2个翻译的工作
    - 改变2个翻译使用的语言也不影响上下2个层次的工作
- 分层思想被认为有害的地方？
## Internet 协议栈
- 应用层: 网络应用
  - 为人类用户或者其他应用进程提供网络应用服务
  - FTP, SMTP, HTTP,DNS
- 传输层: 主机之间的数据传
  - 在网络层提供的端到端通信基础上，细分为进程到进程，将不可靠的通信变成可靠地通信
  - TCP, UDP
- 网络层: 为数据报从源到目的选择路由
  - 主机主机之间的通信，端到端通信，不可靠
  - IP, 路由协议
- 链路层: 相邻网络节点间的数据传输
  - 2个相邻2点的通信，点到点通信，可靠或不可靠
  - 点对对协议PPP, 802.11(wifi), Ethernet
- 物理层: 在线路上传送bit
## ISO/OSI 参考模型
- 表示层: 允许应用解释传输的数据, e.g., 加密，压缩，机器相关的表示转换
- 会话层: 数据交换的同步，检查点，恢复
- 互联网协议栈没有这两层!
  - 这些服务，如果需要的话，必须被应用实现
  - 需要吗?
## 各层次的协议数据单元
- 应用层：报文(message)
- 传输层：报文段(segment)：TCP段，UDP数据报
- 网络层：分组packet（如果无连接方式：数据报datagram）
- 数据链路层：帧(frame)
- 物理层：位(bit)

