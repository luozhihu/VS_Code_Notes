## Abstact
随着工业4.0的到来，网络终端，不再是传统的PC机，而是实际生活中的各种接入网。在工业领域中，网络终端表现为各种生产设备，这些生产设备每天产生海量的数据。如何高效，稳定和安全的管理这些IIoT数据一直是高校，研究所和科技公司重点关注的问题。目前，绝大多数的网络路由方式是分布式的，这是造成互联网僵化的主要原因之一。由于分布式的网络结构，管理IIoT数据的难度大大增加。因此，集中式的网络虚拟化技术被认为是解决互联网僵化的重要技术之一。我们研究了虚拟网络嵌入 (VNE) 技术在无线网络环境中管理IIoT设备数据的应用，该技术在可扩展性和灵活性方面具有巨大优势。在VNE领域，各种启发式算法和只能算法被提出。然而，VNE过程存在的过度训练问题还没有算法能解决。因此，我们提出了一种自适应学习辅助的虚拟网络嵌入算法，称为 ALA-VNE。为了提高训练网络的灵活性，当收到虚拟网络请求时，我们根据虚拟网络请求中的信息决定是否、何时以及如何学习。为了提高算法的稳定性，我们自适应地调整训练网络的参数以适应当前VNR的特点。为了提高模型的聚合速度并降低通信成本，我们设置了一个阈值来处理边缘数据而不干扰训练网络的增长。在嵌入阶段，算法对训练样本进行分类，采用不同的训练策略，解决了算法过度训练的问题。大量仿真结果表明，算法ALA-VNE的收益/成本比为80\%，接受率为23\%，稳定性为21\%，总收益比其他算法高60\%基准算法，分别

## Introduction

近年来，碳排放问题不断出现在各国的谈判桌上。碳排放是导致全球气候变暖的重要原因之一，并增加了极端天气出现的机率。2018年，1.57亿人遭遇了极端天气的折磨（Watts等人，2018）。世界卫生组织预测，从2030年到2050年，约25万人因气候变化死亡。

随着第四次工业革命的到来，连接在互联网的IIoT设备不断增加，随之而来的是越来越多的数据中心。2010年，数据中心的能源消耗放几乎占到了全球的1.1-1.5%。庞大的能源消耗直接提高了二氧化碳的排放，导致全球气候变化，间接影响到人们的健康。此外，根据Barroso等人【4】和《纽约时报》【5】的说法，数据中心物理资源的利用率一般在50%以下，还有很大的提升空间。提高物理资源的利用率，降低闲置物理资源的数量是值得考虑的问题。作为工业4.0技术革新的主要来源之一，网络虚拟化技术（VN）为解决物理资源利用率低的问题提供了新的可能。

NV的目的是把原本只服务于某个场景的物理网络模拟出多个逻辑网络。这样做可以允许一个物理网络被多个应用所共享，并且各个应用相对独立，互不影响。在NV环境中，各应用的需求是以虚拟网络请求的(VNRs)的方式提出的。网络服务提供商将这些VNRs发送给负责该网络片区的服务器。服务器为请求提供足够的计算和带宽资源以满足各应用的需求，也就是虚拟网络嵌入(VNE)过程【】【】。

自从无线网络技术普及以来，世界各地的学者和研究员们对于物理资源分配策略进行了充分的研究。【1】提出了一个创新的资源管理框架。该框架的目的是解决不同网络系统的长期独立演化带来的网络固化制约网络资源的合作与整合问题。该框架从两方面入手：1. 无连接的系统架构：为了无链路连接的网络系统可以相互通信和各种网络协议造成的网络兼容性较差的问题。作者考虑了一种集中式架构，在不改变现有网络系统的情况下快速实现HSN中的互连2. 专用资源使用：为了解决特定网络系统的专用协议导致网络资源的专用使用。作者考虑使用软件定义网络（SDN）、网络功能虚拟化（NFV）和机器学习来尝试突破上述限制。

【】提出一个基于负载均衡和QoS的动态资源分配方法。该方法的目的是解决发展相对较慢的智能通信网络使得接入网成为了通信网络的瓶颈。为了解决这个问题，作者利用虚拟网络的高灵活性和异构性，将其融合宽带接入网络。并且证明该方法可以可以提高网络的利用率和经济效益，使网络更加均衡。

随着网络虚拟化技术的兴起，利用网络虚拟化技术结合嵌入算法解决物理资源利用率低的问题已经成为了一种趋势【】【】。目前利用智能算法解决VNR的嵌入问题是一个热点，通过制定某些规则和约束，将VNR请求一一嵌入。此外，大多数智能算法将VNE分为两个步骤：节点映射和链路映射。然而，实际生产过程中IIoT设备的VNRs的数量是庞大的。这样，智能算法的代理可能会陷入过度训练的状态，导致智能算法会对一些请求产生歧视，在工业生产过程中这是不完美的。

目前的VNE算法没有将过渡训练的问题作为研究对象，只是针对某些特定的属性进行优化，比如，隐私、延时和安全等方面。虽然这种方法在它们侧重的领域有不错的效果，但是，在各方面需求比较均衡的工业生产领域，它的表现是不尽人意的，这也是过度训练的表现之一。在工业4.0的时代，IIoT设备对网络的要求是全方位的。显然上诉方法并不能满足IIoT设备对网络的要求。为了解决上述问题，本文提出了一种自适应学习辅助虚拟网络嵌入的算法。本文的主要贡献如下。

-   为了解决IIOT在网络各个方面的平衡要求，本文将优化的强化学习算法--自适应学习算法（AL）应用于VNE问题。 AL可以有效地控制代理的学习方向，并弥补嵌入式网络具有明显缺点的缺点。 IIOT在网络各个方面的平衡要求有效地解决了问题。
-   本文使用AL来兼顾算法性能和代理的生长方向。在AL中我们用策略网络把VNRs管理起来，被管理的VNRs作为训练样本用于代理的训练。在这个过程中，基板网络的cpu、带宽和安全水平被考虑进去。通过这种方式，代理可以得到可控的训练，并且实验结果也是最优的。最后根据训练结果执行嵌入过程。
-   为了体现算法的优越性，本文从长期评价总收益、稳定性、接受率和收入成本比这四个方面将ALA-VNE算法于其他三个经典的VNE算法进行比较。实验表明，在大部分情况下ALA-VNE算法优于其他算法，证明了算法的优越性。

本文的其余部分安排如下。 第二部分描述了现有的 VNE 算法。 第三部分介绍了该方案的框架并提出了评估指标。 第四节详细介绍了我们的 DLA-VNE 算法。 第五节介绍和分析了模拟实验和实验结果。 最后，对全文进行了总结和展望。

## Related works

在本节中，我们将会回顾已有的有关VNE算法的文献【】【】。传统的启发式算法和如今流行的智能算法在VNE问题上的应用多针对嵌入阶段的研究【】【】。实际上学习阶段也是同样重要的【】【】。有许多学者将网络和机器学习结合，让网络有了迭代优化的能力，智能驾驶能够体现这一成果。此外，【】【】等人创新性的引入了虚拟设备的概念，为IIoT的资源分配问题提供了一个方向。随着5g技术的发展导致网络负载急剧增加，【】提出了一种面向服务的网络架构，通过引入服务聚合和缓存(service aggregation and caching, SAaC)机制，有效地降低了流量负载，简化了网络管理。

### Virtual Network Embedding Related Algorithms

一种基于能量平衡和负载平衡的算法被【】纳入虚拟网络嵌入过程。在该论文中一种综合的节点排序方法CNRM被提出，该方法被用来衡量基板节点的重要性。此外，他们利用改进的差异化定价策略，根据衬底链路的资源利用率为其分配不同的权值。一种基于安全级别度量的安全策略被【】提出。该策略利用边缘计算强大的辅助能力，解决VNE过程中的连续性问题。特别的，他们还用到切片技术对边缘节点进行分类，建立虚拟网络。每个虚拟网络位于边缘节点和云服务器之间，负责不同类型的数据请求和事务处理。一种嵌入有限信息披露的多提供商虚拟网络被【】提出。针对基础设施提供商(InPs)与第三方之间信息不透明的现象，文章提出使用VN来作为两者作为信息的传递者。他们首先确定VN提供商的信息获取能力，然后将基于VN请求的特征矩阵划分为可映射到InPs的段。在这个过程中，少量的信息得到了充分的利用。在物理网络拓扑如何影响虚拟网络嵌入质量研究中，【】通过分析底层基质的拓扑结构在不同的互联网服务提供商（ISP）和数据中心网络拓扑下评估在线嵌入模型的精确解，发现使用包含高连通性区域的物理拓扑显著有助于降低拒绝率。他们通过分析被拒绝的VNRs，评估了ISP和数据中心网络相关的主要拒绝原因。一种基于改进遗传算法的虚拟网络嵌入算法被【】提出。该算法针对传统的启发式算法做了三个方面的改进，分别是优化变异过程和改进过程，将交叉过程进行可行性检查，提出染色体适应度函数。改进后的变异过程减少了不必要的带宽资源消耗，加快了求解过程。改进后的改进过程进一步优化了可能解的逻辑位置，提升了算法性能。

### 自适应学习算法相关成果
一种基于自适应学习策略的混合粒子群优化算法被【】提出。他们把自适应学习策略引入粒子群算法中，并且使用一种竞争学习的预测策略来保证算法的有效性。该算法某种程度上解决了传统粒子群算法的早熟收敛问题，并且在许多复杂的优化问题上表现良好，尤其是多模态问题。一种基于层生成算法的深度信任网络自适应学习方法被【】提出。他们针对传统的受限玻尔兹曼机器RBM或深度信任网络DBN模型在学习阶段结构僵化的问题，提出了采用DBN的分层自适应学习方法，根据不同的应用场景给出最适合的候选层。DBN具有合适的网络结构，能够通过预先训练的REM对输入模式的多种特征分层显示更高的分类能力，开发具有自组织机制的DBN自适应学习方法是自然的扩展。为解决日益复杂的机器学习模型造成的学习成本太高的问题，一个深度网络层特异性自适应学习速率算法被【】提出。他们针对反向传播所使用的梯度对于浅层的权值非常小的问题，提出允许较大的学习速率来补偿浅层中较小的梯度。他们还发现深度神经网络存在高误差低曲率鞍点是限制学习速率的主要原因之一。为了解决这个问题，他们让每一层的学习率在低曲率点趋于增加，该方法能够快速避开深度网络中大量出现的高误差、低曲率鞍点。【】通过研究自适应学习率相关问题发现它的方差在学习阶段的早期呈现出异常。为了研究其背后的原因，他们在亚当的基础上提出了修正亚当，通过这种方式来修复在学习阶段的早期方差呈现出的异常。

不可忽略的是，上述学者的成果一些不足的地方。首先在针对粒子群算法的优化过程中，只是解决了传统算法的早熟收敛问题。粒子群算法会陷入局部最优的问题并没有得到解决。随着互联网的迅速发展，启发式算法已经很难满足需求。研究当前流行的智能算法具有重要意义。其次，在研究学习过程中的反向传播过程中，补偿较小的梯度会间接影响到方差，这不是我们所期望的。最后，目前还没有研究使用修正亚当来修复VNE过程中造成的误差。在本文中，我们将结合修正亚和传播补偿，运用强化学习来研究VNE算法。

## 网络模型和问题陈述

在本节中，我们首先介绍基板网络和虚拟网络的模型，然后简要描述需要解决的问题和解决方案。

我们考虑如图2所示的虚拟网络嵌入体系结构。工业物联网在电力、智能居住、航空互联、自动驾驶、智能医疗等领域的典型应用，通过网络连接工业互联网设备，实现万物互联的效果。部署在云端服务器的应用通过北向接口接收各种工业设备的VNR和节点状态信息，并将这些重要信息处理后作为训练样本辅助算法学习。ALA-VNE根据对工业物联网设备的不同需求，对工业物联网设备的VNR进行进一步处理，并将VNR嵌入到云中。最后给出了一个合适的嵌入解。

### 虚拟化过程

对于ISP来说，透露详细的拓扑信息是不被允许的。例如详细的路由信息就被ISP视为禁止分享的信息，取而代之的是，一些不敏感的信息。与ISP提供的信息不同，公开在应用上的数据是详尽的，例如，某些大型的软件供应商会公布有关网络和流量的统计信息。关于位置和参与者的其他信息由数据库收集后发布。

基于上述发现，我们假定不能获得详细的VNR。通过不被视为机密数据的应用数据来丰富VNR，例如节点位置，节点间带宽等数据。链路带宽可以抽象为对应节点间ISP收取的通讯费用或者维护和运营成本。由于所有的网络信息是公开的，所以ISP数据的机密性不影响网络虚拟化过程。这基本上构成了用于VNR分区的信息。网络虚拟化过程可以简单描述为被运行在特定系统上的网络应用通过收集节点提供的信息和公开在应用上的信息等等虚拟出迎合各个节点需求的网络映射方案。

### 衬底网络模型

我们可以用图论的知识来表示基底网络퐺푠 使用加权无向图。如下所示：퐺푠 = (푁푠, 퐿푠), （1） 在哪里푁푠 = (푁푠 1.푁푠 2.푁푠 푀) 表示基板节点集，以及퐿푠 = (퐿푠 1.퐿푠 2.퐿푠 퐶) 表示基板链接集。푁푠 푖 , 1.≤ 푖 ≤ 푀, 包含节点푖’s基板属性，如CPU容量、传播延迟、硬盘容量和随机读写速度。퐿푠 푗, 1.≤ 푗 ≤ 퐶, 由链路的距离、位置和带宽组成푗. 在本文中，我们主要考虑节点的CPU容量和位置，以及链路的带宽和距离

### 虚拟网络模型

如图2所示，虚拟网络模型퐺푣 与衬底网络模型类似，可表示为퐺푣 = (푁푣, 퐿푣), （2） 在哪里푁푣 = (푁푣 1.푁푣 2.푁푣 퐷) 表示虚拟节点集，以及퐿푣 = (퐿푣 1.퐿푣 2.퐿퐸 퐶 ) 表示虚拟链接集。푁푣 푖 , 1.≤ 푖 ≤ 퐷, 包含节点푖’VNR的属性，例如CPU容量、传播延迟和内存容量。퐿푣 푗 , 1.≤ 푗 ≤ 퐸, 由VNR中的属性组成，包括带宽、距离和虚拟链路的相对位置푗.

### 虚拟网络嵌入模型

VNE过程是一个匹配请求的资源与提供的资源的过程。为此我们需要提供一组候选资源，该组资源可以满足请求节点的需求（CPU、位置和安全性等）。图三展示了，三个节点的请求的嵌入过程，这个过程通常分为三步：
1. VNR拓扑阶段：在图三中，节点间的带宽被带宽矩阵表示。该矩阵基本抽象了这三个节点间所有带宽需求，同时进一步的表示了包括中间节点的带宽需求。因此，无论虚拟节点如何映射，这都是服务于基于带宽矩阵拓展出的VNR。为了减少可能解被排除的概率，特定映射的评估将会由特定算法代替。
2. 节点映射阶段：在节点映射阶段，虚拟节点被安排到合适的基板节点上，并且尽可能的满足该节点的约束条件。值得注意的是，基板节点的选取是可以跨域的。如图三所示，满足虚拟节点约束的节点分布在不同的ISP中，我们把这些节点称之为候选节点。例如虚拟节点$n^i_v$被映射到$n^j_s$可以表示为：<br />
$CPU(n^i_v) \le CPU(n^j_s)\quad and\quad n^j_s \in Candidate(n^i_v)$ [1]
<br />
其中，  公式【1】表示虚拟节点$n^i_v$的CPU容量小于等于基板节点$n^j_s$的CPU容量，并且基板节点$n^j_s$属于虚拟节点$n^i_v$的候选节点集合。
3. 链路映射阶段：在链路映射阶段，虚拟链路被安排到合适的基板链路，该基板链路可以满足虚拟链路的资源约束。例如，虚拟链路$(n^k_v,n^l_v)$被映射到基板链路$(n^m_s,n^n_s)$可以表示为：<br />
$bandwidth(n^k_v,n^l_v)\quad \le \quad bandwidth(n^m_s,n^n_s)\quad and\quad link(n^m_s,n^n_s) \ne null$,    [2]<br />
公式【2】表示虚拟链路$link(n^k_v,n^l_v)$的带宽资源小于等于基板链路$link(n^m_s,n^n_s)$的带宽资源，并且节点$n^m_s$与节点$n^n_s$必须存在于候选节点集$Candidate(n^i_v)$中。其中$bandwidth(n^k_v,n^l_v)$,$bandwidth(n^m_s,n^n_s)$分别代表虚拟链路$link(n^k_v,n^l_v)$的带宽和基板链路$link(n^m_s,n^n_s)$的带宽。

### 卷积核与特征矩阵
我们使用的自适应学习模型是基于卷积神经网络的。卷积神经网络的关键是构造合适的卷积核与特征矩阵。本文将VNR抽象成一个二维的矩阵作为卷积核。为了描述物理节点与链路间的关系，我们把物理网络抽象为一个球面。

  

## 绩效评估指标

虚拟网络嵌入的目的是尽可能的满足多个目标的需求。对于InP，他们希望使用有限的网络资源获得尽可能多的接受VNR，同时获得大量的收益来应对相对固定的运营和维护成本。为了评价算法在上述目标中的表现，我从计算、可用性和鲁棒性三个方向来判断算法是否能达到上述优异性能。我们使用四个指标：收入消耗的比率、总利润、稳定性和接收VNR的比率来评估算法【1】。下面是我们对上述四个指标的定义。

### VNE的收入和成本比率

收入成本比直观地反映了VNE的利润率。我们使用VNR的虚拟节点CPU容量和虚拟链路带宽来表示收入，基板节点CPU容量和基板链路带宽来表示成本。因此，收入成本比푅∕퐶 可计算为：

$R/C=\frac{\sum\limits_{n^v_i \in N_v}CPU(n^v_i)+\sum\limits_{link(n^v_{k1},n^v_{k2}) \in L_v}bandwidth(n^v_{k1},n^v_{k2})f_v(k1,k2)}{\sum\limits_{n^s_j \in N_s}CPU(n^s_j)+\sum\limits_{link(n^s_{l1},n^s_{l2}) \in L_s}bandwidth(n^s_{l1},n^s_{l2})f_s(l1,l2)}$,

其中，$CPU(n^v_i)$表示虚拟节点$n^v_i$的CPU容量，并且$n^v_i$属于虚拟节点集合$N_v$。$bandwidth(n^v_{k1},n^v_{k2})$表示虚拟链路链路$link(n_{k1}^v,n_{k2}^v)$的带宽资源，并且虚拟链路$link(n_{k1}^v,n_{k2}^v)$属于虚拟链路集合$L_v$。$f_v(k1,k2)$表示虚拟链路$link(n_{k1}^v,n_{k2}^v)$的优先级指数，$\sum\limits_{link(n^v_{k1},n^v_{k2}) \in L_v}f_v(k1,k2)=size(L_V)$。VNE的收入由嵌入成功的VNRs的虚拟链路带宽和虚拟节点CPU容量决定。由于不同链路的重要性不同，所以我们引入了优先级函数$f_v$。$CPU(n^s_j)$表示虚拟节点$n^s_j$的CPU容量，并且$n^s_j$属于基板节点集合$N_j$。$bandwidth(n^s_{l1},n^s_{l2})$表示基板链路链路$link(n_{l1}^s,n_{l2}^s)$的带宽资源，并且基板链路$link(n_{l1}^s,n_{l2}^s)$属于基板链路集合$L_v$。$f_s(l1,l2)$表示基板链路$link(n_{l1}^s,n_{l2}^s)$的繁忙指数,$\sum\limits_{link(n^s_{l1},n^s_{l2}) \in L_s}f_s(l1,l2)=size(L_s)$。VNE的成本主要由节点和链路成本两部分组成，此外我们还引入了函数$f_s$来计算基板链路的繁忙程度。

### VNE的总利润

成本收入比包含的信息是有限的，它并不能反映单次映射的表现。然后，比较差的映射过程正是我们应该重点优化的。所以我们把总利润最为评估指标之一，它的波动曲线可以很好的展示每次映射效果。该指标由收入和成本之间的差额组成。它可以用푇 푃 像 

$TP=\sum\limits_{n^v_i \in N_v}CPU(n^v_i)+\sum\limits_{link(n^v_{k1},n^v_{k2}) \in L_v}bandwidth(n^v_{k1},n^v_{k2})f_v(k1,k2)\\-\sum\limits_{n^s_j \in N_s}CPU(n^s_j)-\sum\limits_{link(n^s_{l1},n^s_{l2}) \in L_s}bandwidth(n^s_{l1},n^s_{l2})f_s(l1,l2)$


### VNE的稳定性

稳定地将VNR嵌入衬底网络也是我们需要考虑的问题之一。我们使用VNR嵌入速度波动的幅度来表示VNE算法在一段时间内的稳定性。VNR嵌入速度的波动越小，VNE算法越稳定，反之亦然。因此，可以通过以下公式计算VNE算法的稳定性：푆 像

稳定地将VNR嵌入衬底网络也是我们需要考虑的问题之一。我们使用VNR嵌入准确度来表示VNE算法一次请求的稳定性。稳定性差的算法对于计算过程的误差不敏感，即稳定的算法能够得到原问题相邻问题的精确解。一个VNR的嵌入结果可以看作是算法得出的一个近视解。面对不同的VNR（参数发生改变是作为扰动）嵌入结果会受到不同程度的影响。可以通过以下公式计算VNE算法抵御扰动的能力：

$S=\frac{1}{n-1}\sum\limits_{vnr_i\in VNR}(TP(vnr_i)-revenues(vnr_i))^2$

我们利用应用统计学的知识，用收益的样本方差来表示算法稳定性。其中$VNR$表示虚拟网络请求的集合。$TP(vnr_i)$表示在嵌入过程中虚拟网络请求$vnr_i$的利润。$revenues(vnr_i)$表示请求$vnr_i$的收益用来作为精确解。

### VNE接受率

接受率表示为在整个VNR嵌入过程中成功的VNR数量与算法调用次数的比率，表示为퐴퐶 像

$AC=\frac{size(VNR)}{\sum\limits_{vnr_i\in VNR}frequency(vnr_i)}$

在公式【1】中，分子表示$VNR$的规模，分母表示调用嵌入算法的总次数。其中$frequency(vnr_i)$表示虚拟网络请求$vnr_i$的调用算法的频率。

## 拟提出的VNE算法初始化指南

这里，我们将参考A等人的初始化策略，来分析样本删除、代理参数更新和自调整阈值对自适应学习算法性能的影响，并为其初始化提供一些指导。VNR的相对误差$E_r$是基于ALA-VNE算法的预测结果计算出来的，因此，允许误差在合理范围（使用阈值$Threshold(action)$表示）内波动能够有效提高算法的表现。我们把相对误差分为三个级别：样本删除、代理参数更新和自调整阈值。$Threshold(delete)$,$Threshold(updata)$和$Threshold(adaption)$分别代表上述三个等级的阈值。

阈值$Threshold(delete)$对算法性能和算法长期嵌入结果的影响最大。当阈值$Threshold(delete)$太大时，那么大部分VNRs将不会占用代理的训练资源，算法性能大大提高。然而，代理得不到足够的训练，嵌入结果将会大大收到影响。因此阈值$Threshold(delete)$的取值至关重要。自适应的阈值$Threshold(delete)$会导致算法十分不稳定，但是在实际生产过程中，算法稳定性比算法性能重要得多。因此，我们设置阈值$Threshold(delete)$为不可变的。即使是这样，算法ALA-VNE也能在保证较高的稳定性的同时拥有比传统的启发式算法更好的性能表现。

大量相似的样本被重复训练会使训练代理僵化，阈值$Threshold(adaption)$是防止过度训练的关键参数之一。当VNR的相对误差在自调整阈值区域内时，算法立即更新阈值。但是，过大或者过小的阈值$Threshold(adaption)$都会影响算法表现。如果选择较大的值，训练代理的各个参数收敛的时间将会大大增加。反之，选择比较小的值，那么很多有价值的训练样本将会被忽略。所以，我们为兼顾算法收敛速度和训练代理对训练样本的敏感度，将阈值$Threshold(adaption)$维持在一个水平，该水平能够使得$50\%$$E_r$超过阈值$Threshold(updata)$的VNRs被纳入自调整阈值区域。

## ALA-VNE算法的嵌入步骤 
当前大部分的网络提供的是分布式的服务，这种服务在VNRs数量较少且分布相对集中的情况下工作良好。然而，在IIoT中各类智能设备的使用高峰期，大量VNR向服务器发出请求，这导致网络中某些链路或者节点出现拥塞的情况。根据分布式网络的特性，网络一旦出现拥塞导致请求不断超时重发，加速网络的瘫痪。举个例子：在下班高峰期，如果某条主干道出现了堵车，会导致其他空闲的路段不能利用起来，大大浪费了资源。算法ALA-VNE采用集中式的方式合理的调配每个VNR，实现网络资源的合理调配。传统的算法存在一下问题。例如，大量的训练样本同时进入训练网络，使训练网络变得僵化，大量的VNR在训练队列中等待，使网络延迟增加，重要数据需要加密，导致延迟高。这些导致VNR嵌入结果在预期和结果之间存在较大差异（Cheng、Su、Zhang、Wang、Yang、Luo和Wang，2011；Mijumbi、Gorricho、Serrat、Claeys、Famaey和Turck，2014）。为了解决上述问题，我们采用分而治之的思想，提出了一种VNE算法ALAVNE，并在不同的约束条件下实现了不同的VNE策略，以提高VNRs请求的嵌入效率。 

在安全性、链路带宽和节点CPU容量三个约束条件下，我们设计了ALA-VNE算法的自适应的学习方案。该方案根据VNRs的特征矩阵建立起VNRs的画像，这些画像被分为三种，即跳过训练阶段、进入训练网络和进入训练等待序列。
跳过训练阶段的目的是为了提升提升算法性能和防止训练网络过拟合。进入训练网络的目的是把有价值的训练样本纳入到代理网络中，进而加速算法收敛速度。进入等待训练序列的目的是为了不丢弃不满足进入训练网络但是有价值的样本。

该方案将请求区域划分为三个不同的子区域，即跳过训练阶段、进入训练网络和进入训练等待序列。当样本的三个约束落在跳过训练区域时，相应的训练样本不会添加到训练网络中，而是直接进入嵌入阶段。当样本落入进入训练阶段的区域时，样本将更新训练网络参数并嵌入到物理网络中。当样本落入等待训练区域时，训练样本将等待训练网络参数更新，然后重新分配等待的训练样本。


显然，可以选择低于代理参数更新阈值$Threshold(updata)$的样本更新代理参数。在这个过程中，样本被限制在一定的范围内，因此样本参数更新的幅度是稳定的。如果参数更新阈值$Threshold(updata)$的初始化值等于自调整阈值区域的阈值或者样本删除区域的阈值的最小值，即固定代理参数。如果选择的阈值接近删除区域的阈值的最小值，那么将会有很少的样本被用来更新代理参数，但是算法性能会有一定的提升。如果选择的阈值接近自调整阈值区域的阈值，那么将会有大量的样本被用来调整代理参数，并且大量的样本被纳入训练序列的末尾。训练网络将会加快逼近目标函数。代理参数更新本质上也是自我调节。
### VNR特征提取
在实际生产当中，客户对网络的需求是复杂且多样的，导致原始VNRs中包含大量冗余且无序的信息。从原始的VNRs中提取出有价值的特征信息是一个艰难的任务。为了解决VNRs的特征提取问题，我们为用户提供统一的VNRs接口，该接口只关注少数算法ALA-VNE需要用到的数据。这不仅解决了VNRs的特征提取问题，而且可以让用户更加高效的提出VNRs。下面是算法ALA-VNE需要用到的特征数据。


安全级别（SL）：在IIoT中，数据涉及多个领域，数据就是金钱。因此，数据的安全性是必须考虑的问题之一，不同数据的安全系数也不同。由于硬件和协议层面的安全级别不在我们的考虑范围内，所以我们使用节点平均共享次数和链路平均共享次数来描述网络的安全系数，如下所示

其中$𝑛𝑢𝑚𝑏𝑒𝑟(𝑙𝑖𝑛𝑘)$与$𝑛𝑢𝑚𝑏𝑒(𝑛𝑜𝑑𝑒)$分别表示基板链路和基板节点个数。$N_i^s(shares)$和$L_j^S(shares)$分别表示基板节点$i$的共享次数和基板链路$j$的共享次数。特别的,$\gamma$,$0<=\gamma <=1$,可以被用来控制对于基板链路或者基板节点的敏感度。

在生产过程中，客户端连续不断的向网络服务器发出VNRs。因此，我们使用特征矩阵$FW$来作为训练网络的输入。

特征矩阵的表示如下：


ALA-VNE算法的学习过程是非线性的。它将根据当前训练样本中包含的信息调整代理网络的参数。下面我们将会介绍训练代理依据哪些信息自适应调整参数。

我们使用一个策略网络作为学习代理，通过训练学习代理输出每个底层节点的映射概率。在该策略下，VNRs一个接一个的到达。大多数算法在序列中学习所有的训练样本，而ALA算法通过分析VNRs的特征，选择性的进行学习，并且调节学习过程。自适应学习策略如图4所示
## 实验结果和分析
| Notation | The idea of algorithms |
| -------- | ---------------------- |
| ALA-VNE  | 根据虚拟节点与虚拟链路的特征计算出候选节点的集合，并且将候选节点按照优先级排序。通过最小生成树算法选择最少的链路消耗。最后把最小生成树映射到基板网络。                   |
| DC-VNE   | 基于启发式思想,将映射过程分为节点映射和链路映射两步分别完成,在节点映射过程同时考虑节点的资源属性和拓扑属性,采用递归方程精确求解每个节点的重要性因子,然后采用基于节点重要性排序的贪婪算法完成映射,在链路映射过程采用带时延约束的K最短路径法.                      |
| MC-VNE   | 收集所有满足资源需求的节点，通过最小生成树算法求出所有解，然后按照可行性对该树进行修剪直到求出唯一解。最后将唯一解嵌入到基板网络。                      |
| SA-VNE   | 将基板节点属性的特征矩阵作为输入计算出每个基板节点的映射概率。根据节点的映射概率，采用广度优先策略进行映射。                     |







我们提出了一种在 IIoT 场景中的动态学习助手虚拟网络嵌入算法。 该算法主要用于嵌入虚拟网络请求。 嵌入过程主要由学习代理完成，无需手动设计嵌入规则。 本文提出的“先管理后映射”的映射策略，以及三种分类机制、节点重要性的度量和最小生成树算法，显著的降低了算法过拟合的几率，为防止互联网僵化和提高网络服务质量做出了重要的贡献。 仿真结果表明，所提算法在利润、稳定性、收入成本比和接受率等方面都是有效的。

未来，我们将分析更多基板节点的物理特性，构建更合理的输入输出矩阵，得到更能反映实际需求的结果。 我们将继续探索算法学习过程前后的优化方法，设计更好的训练样本管理策略。